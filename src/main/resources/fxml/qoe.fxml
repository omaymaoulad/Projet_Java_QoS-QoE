<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.shape.*?>
<?import javafx.geometry.Insets?>

<ScrollPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.ensah.qoe.Controller.QoEController"
            fitToWidth="true"
            vbarPolicy="AS_NEEDED"
            style="-fx-background: #f8fafc;">

    <VBox spacing="24" style="-fx-padding: 24; -fx-background-color: #f8fafc;">

        <!-- ==================== HEADER MODERNE ==================== -->
        <VBox spacing="0"
              style="-fx-background-color: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%);
                     -fx-background-radius: 16;
                     -fx-padding: 32 40;
                     -fx-effect: dropshadow(gaussian, rgba(245,158,11,0.3), 20, 0, 0, 8);">

            <HBox alignment="CENTER_LEFT" spacing="20">
                <!-- Icon Badge -->
                <StackPane>
                    <Circle radius="32" fill="rgba(255,255,255,0.2)"/>
                    <Circle radius="28" fill="rgba(255,255,255,0.3)"/>
                    <Text text="â­" style="-fx-font-size: 32;"/>
                </StackPane>

                <VBox spacing="4">
                    <Label text="Quality of Experience"
                           style="-fx-text-fill: white;
                                  -fx-font-size: 32;
                                  -fx-font-weight: 700;
                                  -fx-font-family: 'Segoe UI', Arial;"/>
                    <Label text="Dashboard d'analyse de l'expÃ©rience utilisateur"
                           style="-fx-text-fill: rgba(255,255,255,0.9);
                                  -fx-font-size: 15;"/>
                </VBox>
            </HBox>
        </VBox>

        <!-- ==================== IMPORT & ANALYSE SECTION ==================== -->
        <HBox spacing="16" alignment="CENTER">

            <!-- Import Button -->
            <VBox spacing="8" alignment="CENTER"
                  style="-fx-background-color: white;
                         -fx-background-radius: 12;
                         -fx-padding: 24 32;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 12, 0, 0, 4);
                         -fx-min-width: 280;">
                <Text text="ðŸ“" style="-fx-font-size: 28;"/>
                <Button fx:id="importCsvButton"
                        text="Importer CSV"
                        onAction="#importerCsv"
                        style="-fx-background-color: #f59e0b;
                               -fx-text-fill: white;
                               -fx-font-size: 14;
                               -fx-font-weight: 600;
                               -fx-background-radius: 8;
                               -fx-padding: 12 32;
                               -fx-cursor: hand;
                               -fx-effect: dropshadow(gaussian, rgba(245,158,11,0.3), 8, 0, 0, 2);"/>
                <Label text="DonnÃ©es QoE / Telco"
                       style="-fx-text-fill: #64748b; -fx-font-size: 12;"/>
            </VBox>

            <!-- Divider -->
            <Separator orientation="VERTICAL" style="-fx-padding: 0 8;"/>

            <!-- Mode Selection -->
            <VBox spacing="12" alignment="CENTER"
                  style="-fx-background-color: white;
                         -fx-background-radius: 12;
                         -fx-padding: 24 32;
                         -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 12, 0, 0, 4);
                         -fx-pref-width: 400;">

                <Label text="Mode d'analyse"
                       style="-fx-text-fill: #0f172a;
                              -fx-font-size: 16;
                              -fx-font-weight: 600;"/>

                <HBox spacing="12" alignment="CENTER">
                    <RadioButton fx:id="radioClient"
                                 text="Par Client"
                                 onAction="#modeClient"
                                 style="-fx-font-size: 13; -fx-text-fill: #334155;"/>
                    <RadioButton fx:id="radioGenre"
                                 text="Par Genre"
                                 onAction="#modeGenre"
                                 style="-fx-font-size: 13; -fx-text-fill: #334155;"/>
                    <RadioButton fx:id="radioZone"
                                 text="Par Zone"
                                 onAction="#modeZone"
                                 style="-fx-font-size: 13; -fx-text-fill: #334155;"/>
                </HBox>

                <!-- Selection Boxes -->
                <HBox fx:id="clientSelectionBox" spacing="12" visible="false" alignment="CENTER">
                    <Label text="Client :" style="-fx-font-weight: 600; -fx-text-fill: #475569;"/>
                    <ComboBox fx:id="clientCombo" promptText="SÃ©lectionner..."
                              style="-fx-pref-width: 220;"/>
                </HBox>

                <HBox fx:id="genreSelectionBox" spacing="12" visible="false" alignment="CENTER">
                    <Label text="Genre :" style="-fx-font-weight: 600; -fx-text-fill: #475569;"/>
                    <ComboBox fx:id="genreCombo" promptText="SÃ©lectionner..."
                              style="-fx-pref-width: 220;"/>
                </HBox>

                <HBox fx:id="zoneSelectionBox" spacing="12" visible="false" alignment="CENTER">
                    <Label text="Zone :" style="-fx-font-weight: 600; -fx-text-fill: #475569;"/>
                    <ComboBox fx:id="zoneCombo" promptText="SÃ©lectionner..."
                              style="-fx-pref-width: 220;"/>
                </HBox>
            </VBox>
        </HBox>

        <!-- ==================== QoE GLOBAL CARD ==================== -->
        <StackPane style="-fx-background-color: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                          -fx-background-radius: 16;
                          -fx-padding: 32;
                          -fx-effect: dropshadow(gaussian, rgba(245,158,11,0.2), 16, 0, 0, 6);
                          -fx-border-color: #fbbf24;
                          -fx-border-width: 2;
                          -fx-border-radius: 16;">
            <VBox spacing="8" alignment="CENTER">
                <HBox spacing="12" alignment="CENTER">
                    <Text text="ðŸŽ¯" style="-fx-font-size: 28;"/>
                    <Label text="QoE GLOBAL"
                           style="-fx-text-fill: #78350f;
                                  -fx-font-size: 20;
                                  -fx-font-weight: 700;
                                  -fx-letter-spacing: 1;"/>
                </HBox>

                <Label fx:id="overallQoeLabel"
                       text="â€”"
                       style="-fx-text-fill: #d97706;
                              -fx-font-size: 48;
                              -fx-font-weight: 700;"/>

                <Label text="Score moyen de qualitÃ©"
                       style="-fx-text-fill: #92400e; -fx-font-size: 13;"/>
            </VBox>
        </StackPane>

        <!-- ==================== DYNAMIC CONTENT AREA ==================== -->
        <!-- TABLE VIEW -->
        <VBox fx:id="tableContainer"
              visible="false"
              managed="false"
              spacing="16"
              style="-fx-background-color: white;
                     -fx-background-radius: 16;
                     -fx-padding: 24;
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 12, 0, 0, 4);">

            <HBox alignment="CENTER_LEFT" spacing="12">
                <Text text="ðŸ‘¥" style="-fx-font-size: 24;"/>
                <Label text="Liste des Clients"
                       style="-fx-font-size: 20;
                              -fx-font-weight: 600;
                              -fx-text-fill: #0f172a;"/>
            </HBox>

            <TableView fx:id="clientTable"
                       style="-fx-background-color: transparent;
                             -fx-background-radius: 8;"/>
        </VBox>

        <!-- GRAPH VIEW -->
        <VBox fx:id="graphContainer"
              visible="true"
              managed="true"
              spacing="16"
              style="-fx-background-color: white;
                     -fx-background-radius: 16;
                     -fx-padding: 24;
                     -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 12, 0, 0, 4);">

            <HBox alignment="CENTER_LEFT" spacing="12">
                <Text text="ðŸ“Š" style="-fx-font-size: 24;"/>
                <Label text="Analyse par Genre"
                       style="-fx-font-size: 20;
                              -fx-font-weight: 600;
                              -fx-text-fill: #0f172a;"/>
            </HBox>
        </VBox>

        <!-- ==================== MÃ‰TRIQUES SUBJECTIVES ==================== -->
        <VBox spacing="16">
            <HBox alignment="CENTER_LEFT" spacing="12">
                <Text text="ðŸ’­" style="-fx-font-size: 22;"/>
                <Label text="MÃ‰TRIQUES SUBJECTIVES"
                       style="-fx-text-fill: #0f172a;
                              -fx-font-size: 18;
                              -fx-font-weight: 700;
                              -fx-letter-spacing: 0.5;"/>
            </HBox>

            <GridPane hgap="16" vgap="16">
                <columnConstraints>
                    <ColumnConstraints percentWidth="50"/>
                    <ColumnConstraints percentWidth="50"/>
                </columnConstraints>

                <!-- Satisfaction -->
                <VBox GridPane.columnIndex="0" GridPane.rowIndex="0"
                      spacing="12"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 20;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);
                             -fx-border-color: #fbbf24;
                             -fx-border-width: 0 0 0 4;
                             -fx-border-radius: 12;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Text text="ðŸ˜Š" style="-fx-font-size: 22;"/>
                        <Label text="Satisfaction"
                               style="-fx-font-size: 14;
                                      -fx-font-weight: 600;
                                      -fx-text-fill: #475569;"/>
                    </HBox>
                    <Label fx:id="satisfactionLabel"
                           text="â€”"
                           style="-fx-font-size: 24;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #f59e0b;"/>
                </VBox>

                <!-- QualitÃ© VidÃ©o -->
                <VBox GridPane.columnIndex="1" GridPane.rowIndex="0"
                      spacing="12"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 20;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);
                             -fx-border-color: #ef4444;
                             -fx-border-width: 0 0 0 4;
                             -fx-border-radius: 12;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Text text="ðŸ“¹" style="-fx-font-size: 22;"/>
                        <Label text="QualitÃ© VidÃ©o"
                               style="-fx-font-size: 14;
                                      -fx-font-weight: 600;
                                      -fx-text-fill: #475569;"/>
                    </HBox>
                    <Label fx:id="videoQualityLabel"
                           text="â€”"
                           style="-fx-font-size: 24;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #ef4444;"/>
                </VBox>

                <!-- QualitÃ© Audio -->
                <VBox GridPane.columnIndex="0" GridPane.rowIndex="1"
                      spacing="12"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 20;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);
                             -fx-border-color: #8b5cf6;
                             -fx-border-width: 0 0 0 4;
                             -fx-border-radius: 12;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Text text="ðŸŽµ" style="-fx-font-size: 22;"/>
                        <Label text="QualitÃ© Audio"
                               style="-fx-font-size: 14;
                                      -fx-font-weight: 600;
                                      -fx-text-fill: #475569;"/>
                    </HBox>
                    <Label fx:id="audioQualityLabel"
                           text="â€”"
                           style="-fx-font-size: 24;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #8b5cf6;"/>
                </VBox>

                <!-- InteractivitÃ© -->
                <VBox GridPane.columnIndex="1" GridPane.rowIndex="1"
                      spacing="12"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 20;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);
                             -fx-border-color: #3b82f6;
                             -fx-border-width: 0 0 0 4;
                             -fx-border-radius: 12;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Text text="âš¡" style="-fx-font-size: 22;"/>
                        <Label text="InteractivitÃ©"
                               style="-fx-font-size: 14;
                                      -fx-font-weight: 600;
                                      -fx-text-fill: #475569;"/>
                    </HBox>
                    <Label fx:id="interactivityLabel"
                           text="â€”"
                           style="-fx-font-size: 24;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #3b82f6;"/>
                </VBox>

                <!-- FiabilitÃ© -->
                <VBox GridPane.columnIndex="0" GridPane.rowIndex="2"
                      GridPane.columnSpan="2"
                      spacing="12"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 20;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);
                             -fx-border-color: #10b981;
                             -fx-border-width: 0 0 0 4;
                             -fx-border-radius: 12;">
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Text text="ðŸ›¡ï¸" style="-fx-font-size: 22;"/>
                        <Label text="FiabilitÃ©"
                               style="-fx-font-size: 14;
                                      -fx-font-weight: 600;
                                      -fx-text-fill: #475569;"/>
                    </HBox>
                    <Label fx:id="reliabilityLabel"
                           text="â€”"
                           style="-fx-font-size: 24;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #10b981;"/>
                </VBox>
            </GridPane>
        </VBox>

        <!-- ==================== MÃ‰TRIQUES OBJECTIVES ==================== -->
        <VBox spacing="16">
            <HBox alignment="CENTER_LEFT" spacing="12">
                <Text text="ðŸ“ˆ" style="-fx-font-size: 22;"/>
                <Label text="MÃ‰TRIQUES OBJECTIVES"
                       style="-fx-text-fill: #0f172a;
                              -fx-font-size: 18;
                              -fx-font-weight: 700;
                              -fx-letter-spacing: 0.5;"/>
            </HBox>

            <GridPane hgap="16" vgap="16">
                <columnConstraints>
                    <ColumnConstraints percentWidth="25"/>
                    <ColumnConstraints percentWidth="25"/>
                    <ColumnConstraints percentWidth="25"/>
                    <ColumnConstraints percentWidth="25"/>
                </columnConstraints>

                <!-- Buffering -->
                <VBox GridPane.columnIndex="0" spacing="10"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 16;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
                    <Text text="â³" style="-fx-font-size: 20;"/>
                    <Label text="Buffering"
                           style="-fx-font-size: 12;
                                  -fx-text-fill: #64748b;
                                  -fx-font-weight: 500;"/>
                    <Label fx:id="bufferingLabel"
                           text="â€”"
                           style="-fx-font-size: 18;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #0f172a;"/>
                </VBox>

                <!-- Loading Time -->
                <VBox GridPane.columnIndex="1" spacing="10"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 16;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
                    <Text text="â±ï¸" style="-fx-font-size: 20;"/>
                    <Label text="Loading Time"
                           style="-fx-font-size: 12;
                                  -fx-text-fill: #64748b;
                                  -fx-font-weight: 500;"/>
                    <Label fx:id="loadingTimeLabel"
                           text="â€”"
                           style="-fx-font-size: 18;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #0f172a;"/>
                </VBox>

                <!-- Failure Rate -->
                <VBox GridPane.columnIndex="2" spacing="10"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 16;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
                    <Text text="âŒ" style="-fx-font-size: 20;"/>
                    <Label text="Failure Rate"
                           style="-fx-font-size: 12;
                                  -fx-text-fill: #64748b;
                                  -fx-font-weight: 500;"/>
                    <Label fx:id="failureRateLabel"
                           text="â€”"
                           style="-fx-font-size: 18;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #0f172a;"/>
                </VBox>

                <!-- Streaming Quality -->
                <VBox GridPane.columnIndex="3" spacing="10"
                      style="-fx-background-color: white;
                             -fx-background-radius: 12;
                             -fx-padding: 16;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.06), 10, 0, 0, 3);">
                    <Text text="ðŸ“¶" style="-fx-font-size: 20;"/>
                    <Label text="Streaming"
                           style="-fx-font-size: 12;
                                  -fx-text-fill: #64748b;
                                  -fx-font-weight: 500;"/>
                    <Label fx:id="streamingQualityLabel"
                           text="â€”"
                           style="-fx-font-size: 18;
                                  -fx-font-weight: 700;
                                  -fx-text-fill: #0f172a;"/>
                </VBox>
            </GridPane>
        </VBox>

        <!-- ==================== FOOTER ==================== -->
        <HBox alignment="CENTER" style="-fx-padding: 24 0 0 0;">
            <Label text="QoE Analysis System â€¢ v2.0 â€¢ Â© 2025"
                   style="-fx-text-fill: #94a3b8;
                          -fx-font-size: 12;"/>
        </HBox>

    </VBox>
</ScrollPane>