<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<ScrollPane xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.ensah.qoe.Controller.AnomalyDashboardController"
            style="-fx-background-color: #f8f9fa;"
            fitToWidth="true"
            fitToHeight="false"
            pannable="true"
            prefWidth="1200" prefHeight="650">

    <content>
        <VBox spacing="0">
            <!-- Top: Header avec titre et boutons -->
            <VBox spacing="8" style="-fx-background-color: #e74c3c; -fx-padding: 15;">
                <HBox spacing="15" alignment="CENTER_LEFT">
                    <Label text="Dashboard DÃ©tection d'Anomalies RÃ©seau"
                           style="-fx-text-fill: white; -fx-font-weight: bold;">
                        <font>
                            <Font size="22"/>
                        </font>
                    </Label>

                    <HBox spacing="10" alignment="CENTER_RIGHT" HBox.hgrow="ALWAYS">
                        <Button fx:id="refreshButton" text="ðŸ”„ Actualiser"
                                style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-padding: 8 15;"
                                onAction="#handleRefresh"/>
                        <Button fx:id="goBackButton" text="â† Retour"
                                style="-fx-background-color: #7f8c8d; -fx-text-fill: white; -fx-padding: 8 15;"
                                onAction="#handleGoBack"/>
                    </HBox>
                </HBox>

                <Label fx:id="statusLabel" text="SystÃ¨me prÃªt"
                       style="-fx-text-fill: #ecf0f1; -fx-font-size: 13; -fx-font-weight: bold;"/>
            </VBox>

            <!-- Center: Contenu principal avec TabPane -->
            <TabPane fx:id="visualizationTabPane" tabClosingPolicy="UNAVAILABLE" >

                <!-- Tab 1: Vue d'ensemble -->
                <Tab text="ðŸ“Š Vue d'ensemble">
                  <ScrollPane fitToWidth="true" pannable="true">
                    <VBox spacing="15" style="-fx-background-color: transparent;">
                        <VBox spacing="15" style="-fx-padding: 15;">

                            <!-- KPI Cards -->
                            <GridPane hgap="15" vgap="15">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                </columnConstraints>

                                <!-- Card 1: Total -->
                                <VBox style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);"
                                      GridPane.columnIndex="0">
                                    <Label text="Total Instances" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d; -fx-font-size: 11;"/>
                                    <Label fx:id="totalInstancesLabel" text="50"
                                           style="-fx-font-size: 28; -fx-text-fill: #3498db; -fx-font-weight: bold;"/>
                                    <Label text="mesures analysÃ©es" style="-fx-text-fill: #95a5a6; -fx-font-size: 10;"/>
                                </VBox>

                                <!-- Card 2: Normales -->
                                <VBox style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);"
                                      GridPane.columnIndex="1">
                                    <Label text="Connexions Normales" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d; -fx-font-size: 11;"/>
                                    <Label fx:id="normalCountLabel" text="32"
                                           style="-fx-font-size: 28; -fx-text-fill: #27ae60; -fx-font-weight: bold;"/>
                                    <Label text="connexions saines" style="-fx-text-fill: #95a5a6; -fx-font-size: 10;"/>
                                </VBox>

                                <!-- Card 3: Anomalies -->
                                <VBox style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);"
                                      GridPane.columnIndex="2">
                                    <Label text="Anomalies DÃ©tectÃ©es" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d; -fx-font-size: 11;"/>
                                    <Label fx:id="anomalyCountLabel" text="18"
                                           style="-fx-font-size: 28; -fx-text-fill: #e74c3c; -fx-font-weight: bold;"/>
                                    <Label text="incidents rÃ©seau" style="-fx-text-fill: #95a5a6; -fx-font-size: 10;"/>
                                </VBox>

                                <!-- Card 4: Taux d'anomalies -->
                                <VBox spacing="5" style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);"
                                      GridPane.columnIndex="3">
                                    <Label text="Taux d'Anomalies" style="-fx-font-weight: bold; -fx-text-fill: #7f8c8d; -fx-font-size: 11;"/>
                                    <Label fx:id="anomalyRateLabel" text="36,0%"
                                           style="-fx-font-size: 28; -fx-text-fill: #f39c12; -fx-font-weight: bold;"/>
                                    <ProgressBar fx:id="anomalyRateProgress" prefWidth="120" progress="0.36"
                                                 style="-fx-accent: #f39c12;"/>
                                </VBox>
                            </GridPane>

                            <!-- MÃ©triques de Performance -->
                            <VBox spacing="10" style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸ“ˆ MÃ©triques de Performance du ModÃ¨le"
                                       style="-fx-font-weight: bold; -fx-font-size: 15;"/>

                                <GridPane hgap="25" vgap="12">
                                    <columnConstraints>
                                        <ColumnConstraints prefWidth="140"/>
                                        <ColumnConstraints prefWidth="100"/>
                                        <ColumnConstraints prefWidth="140"/>
                                        <ColumnConstraints prefWidth="100"/>
                                    </columnConstraints>

                                    <Label text="Accuracy (PrÃ©cision):" GridPane.rowIndex="0" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <Label fx:id="accuracyLabel" text="92.5%" GridPane.rowIndex="0" GridPane.columnIndex="1"
                                           style="-fx-font-size: 16; -fx-text-fill: #3498db; -fx-font-weight: bold;"/>

                                    <Label text="Precision:" GridPane.rowIndex="0" GridPane.columnIndex="2"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <Label fx:id="precisionLabel" text="88.3%" GridPane.rowIndex="0" GridPane.columnIndex="3"
                                           style="-fx-font-size: 16; -fx-text-fill: #2ecc71; -fx-font-weight: bold;"/>

                                    <Label text="Recall (Rappel):" GridPane.rowIndex="1" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <Label fx:id="recallLabel" text="85.7%" GridPane.rowIndex="1" GridPane.columnIndex="1"
                                           style="-fx-font-size: 16; -fx-text-fill: #9b59b6; -fx-font-weight: bold;"/>

                                    <Label text="F1-Score:" GridPane.rowIndex="1" GridPane.columnIndex="2"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <Label fx:id="f1ScoreLabel" text="87.0%" GridPane.rowIndex="1" GridPane.columnIndex="3"
                                           style="-fx-font-size: 16; -fx-text-fill: #e67e22; -fx-font-weight: bold;"/>
                                </GridPane>
                            </VBox>

                            <!-- Graphiques -->
                            <HBox spacing="15">
                                <!-- Distribution des anomalies -->
                                <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);"
                                      HBox.hgrow="ALWAYS">
                                    <Label text="Distribution des Types d'Anomalies" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                                    <BarChart fx:id="distributionChart" prefHeight="250" legendVisible="false">
                                        <xAxis>
                                            <CategoryAxis label="Type d'Anomalie"/>
                                        </xAxis>
                                        <yAxis>
                                            <NumberAxis label="Nombre"/>
                                        </yAxis>
                                    </BarChart>
                                </VBox>

                                <!-- Pie Chart -->
                                <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                    <Label text="Proportion Anomalies/Normales" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                                    <PieChart fx:id="anomalyPieChart" prefHeight="250" prefWidth="300" labelLineLength="15"/>
                                </VBox>
                            </HBox>

                            <!-- Historique des prÃ©dictions rÃ©centes -->
                            <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸ“‹ PrÃ©dictions RÃ©centes" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                                <TableView fx:id="recentPredictionsTable" prefHeight="180"/>
                            </VBox>
                        </VBox>
                    </VBox>
                  </ScrollPane>
                </Tab>

                <!-- Tab 2: EntraÃ®nement du modÃ¨le -->
                <Tab text="ðŸŽ“ EntraÃ®nement">
                    <VBox spacing="15" style="-fx-background-color: transparent;">
                        <VBox spacing="15" style="-fx-padding: 15;">
                            <Label text="Configuration et EntraÃ®nement du ModÃ¨le"
                                   style="-fx-font-weight: bold; -fx-font-size: 17; -fx-text-fill: #2c3e50;"/>

                            <!-- Configuration -->
                            <VBox spacing="12" style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="âš™ï¸ Configuration" style="-fx-font-weight: bold; -fx-font-size: 14;"/>

                                <GridPane hgap="12" vgap="12">
                                    <columnConstraints>
                                        <ColumnConstraints prefWidth="180"/>
                                        <ColumnConstraints prefWidth="350"/>
                                    </columnConstraints>

                                    <Label text="Algorithme de dÃ©tection:" GridPane.rowIndex="0" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <ComboBox fx:id="algorithmCombo" prefWidth="320"
                                              GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                                    <Label text="Ratio Train/Test:" GridPane.rowIndex="1" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <HBox spacing="10" GridPane.rowIndex="1" GridPane.columnIndex="1">
                                        <Slider fx:id="trainTestSplitSlider" min="50" max="90" value="80"
                                                showTickLabels="true" showTickMarks="true"
                                                majorTickUnit="10" minorTickCount="4" prefWidth="250"/>
                                        <Label fx:id="splitRatioLabel" text="80/20"
                                               style="-fx-font-weight: bold; -fx-font-size: 13;"/>
                                    </HBox>
                                </GridPane>
                            </VBox>

                            <!-- Actions d'entraÃ®nement -->
                            <HBox spacing="15" style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <VBox spacing="8" HBox.hgrow="ALWAYS">
                                    <Label text="ðŸš€ Lancer l'entraÃ®nement" style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <Button fx:id="trainButton" text="EntraÃ®ner le ModÃ¨le"
                                            prefWidth="180" prefHeight="35"
                                            style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 13;"
                                            onAction="#handleTrainModel"/>
                                    <Button fx:id="visualizeDataButton" text="ðŸ“Š Visualiser les DonnÃ©es"
                                            prefWidth="180" prefHeight="30"
                                            style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-font-size: 12;"
                                            onAction="#handleVisualizeData"/>
                                </VBox>

                                <VBox spacing="5" HBox.hgrow="ALWAYS">
                                    <Label text="Progression:" style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <ProgressBar fx:id="trainingProgressBar" prefWidth="400" progress="0"/>
                                    <Label fx:id="trainingProgressLabel" text="En attente..."
                                           style="-fx-font-size: 11; -fx-text-fill: #7f8c8d;"/>
                                </VBox>
                            </HBox>

                            <!-- Logs d'entraÃ®nement -->
                            <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸ“ Journal d'EntraÃ®nement" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                                <TextArea fx:id="trainingLogArea" prefHeight="220" editable="false"
                                          style="-fx-font-family: 'Courier New'; -fx-font-size: 11; -fx-control-inner-background: #2c3e50; -fx-text-fill: #ecf0f1;"/>
                            </VBox>

                            <!-- Performance chart -->
                            <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸ“ˆ Ã‰volution de la Performance" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                                <LineChart fx:id="performanceChart" prefHeight="220">
                                    <xAxis>
                                        <CategoryAxis label="PÃ©riode"/>
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis label="Score (%)"/>
                                    </yAxis>
                                </LineChart>
                            </VBox>
                        </VBox>
                    </VBox>
                </Tab>

                <!-- Tab 3: PrÃ©diction manuelle -->
                <Tab text="ðŸ”® PrÃ©diction">
                    <VBox spacing="15" style="-fx-background-color: transparent;">
                        <VBox spacing="15" style="-fx-padding: 15;">
                            <Label text="PrÃ©diction d'Anomalies en Temps RÃ©el"
                                   style="-fx-font-weight: bold; -fx-font-size: 17; -fx-text-fill: #2c3e50;"/>

                            <!-- Inputs de prÃ©diction -->
                            <VBox fx:id="predictionInputsContainer" spacing="12" style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="âš™ï¸ ParamÃ¨tres QoS" style="-fx-font-weight: bold; -fx-font-size: 14;"/>

                                <GridPane hgap="12" vgap="15">
                                    <columnConstraints>
                                        <ColumnConstraints prefWidth="160"/>
                                        <ColumnConstraints prefWidth="100"/>
                                        <ColumnConstraints prefWidth="250"/>
                                    </columnConstraints>

                                    <!-- Latence -->
                                    <Label text="Latence (ms):" GridPane.rowIndex="0" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <TextField fx:id="latenceField" text="50" GridPane.rowIndex="0" GridPane.columnIndex="1"
                                               style="-fx-font-size: 12;"/>
                                    <Slider fx:id="latenceSlider" GridPane.rowIndex="0" GridPane.columnIndex="2"/>

                                    <!-- Jitter -->
                                    <Label text="Jitter (ms):" GridPane.rowIndex="1" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <TextField fx:id="jitterField" text="10" GridPane.rowIndex="1" GridPane.columnIndex="1"
                                               style="-fx-font-size: 12;"/>
                                    <Slider fx:id="jitterSlider" GridPane.rowIndex="1" GridPane.columnIndex="2"/>

                                    <!-- Perte -->
                                    <Label text="Perte de Paquets (%):" GridPane.rowIndex="2" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <TextField fx:id="perteField" text="1.0" GridPane.rowIndex="2" GridPane.columnIndex="1"
                                               style="-fx-font-size: 12;"/>
                                    <Slider fx:id="perteSlider" GridPane.rowIndex="2" GridPane.columnIndex="2"/>

                                    <!-- Bande passante -->
                                    <Label text="Bande Passante (Mbps):" GridPane.rowIndex="3" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <TextField fx:id="bandePassanteField" text="50" GridPane.rowIndex="3" GridPane.columnIndex="1"
                                               style="-fx-font-size: 12;"/>
                                    <Slider fx:id="bandePassanteSlider" GridPane.rowIndex="3" GridPane.columnIndex="2"/>

                                    <!-- Signal -->
                                    <Label text="Score Signal (%):" GridPane.rowIndex="4" GridPane.columnIndex="0"
                                           style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <TextField fx:id="signalField" text="80" GridPane.rowIndex="4" GridPane.columnIndex="1"
                                               style="-fx-font-size: 12;"/>
                                    <Slider fx:id="signalSlider" GridPane.rowIndex="4" GridPane.columnIndex="2"/>
                                </GridPane>

                                <!-- Boutons d'action -->
                                <HBox spacing="12" alignment="CENTER">
                                    <Button fx:id="predictButton" text="ðŸ”® PrÃ©dire"
                                            prefWidth="160" prefHeight="40"
                                            style="-fx-background-color: #2ecc71; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;"
                                            onAction="#handlePredict"/>
                                    <Button fx:id="analyzeButton" text="ðŸ” Analyser"
                                            prefWidth="160" prefHeight="40"
                                            style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;"
                                            onAction="#handleAnalyze"/>
                                    <Button text="ðŸ”„ RÃ©initialiser"
                                            prefWidth="160" prefHeight="40"
                                            style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;"
                                            onAction="#handleResetInputs"/>
                                </HBox>
                            </VBox>

                            <!-- RÃ©sultat de prÃ©diction -->
                            <VBox spacing="12" style="-fx-background-color: white; -fx-padding: 20; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸ“Š RÃ©sultat de la PrÃ©diction" style="-fx-font-weight: bold; -fx-font-size: 16;"/>

                                <HBox spacing="40" alignment="CENTER">
                                    <!-- PrÃ©diction -->
                                    <VBox spacing="6" alignment="CENTER">
                                        <Label text="Statut DÃ©tectÃ©" style="-fx-font-size: 12; -fx-text-fill: #7f8c8d;"/>
                                        <Label fx:id="predictionResultLabel" text="--"
                                               style="-fx-font-size: 36; -fx-font-weight: bold; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8;"/>
                                    </VBox>

                                    <!-- Confiance -->
                                    <VBox spacing="6" alignment="CENTER">
                                        <Label text="Niveau de Confiance" style="-fx-font-size: 12; -fx-text-fill: #7f8c8d;"/>
                                        <Label fx:id="confidenceLabel" text="--"
                                               style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #3498db;"/>
                                        <ProgressBar fx:id="confidenceProgressBar" prefWidth="180" progress="0"
                                                     style="-fx-accent: #3498db;"/>
                                    </VBox>
                                </HBox>

                                <!-- Explication -->
                                <Separator/>
                                <VBox spacing="6" style="-fx-background-color: #ecf0f1; -fx-padding: 12; -fx-border-radius: 5; -fx-background-radius: 5;">
                                    <Label text="ðŸ’¡ InterprÃ©tation" style="-fx-font-weight: bold; -fx-font-size: 12;"/>
                                    <Label fx:id="explanationLabel" text="Aucune prÃ©diction effectuÃ©e"
                                           wrapText="true" style="-fx-font-size: 12; -fx-text-fill: #2c3e50;"/>
                                </VBox>
                            </VBox>
                        </VBox>
                    </VBox>
                </Tab>

                <!-- Tab 4: Tests et Analyse -->
                <Tab text="ðŸ§ª Tests &amp; Analyse">
                    <VBox spacing="15" style="-fx-background-color: transparent;">
                        <VBox spacing="15" style="-fx-padding: 15;">
                            <Label text="Tests et Analyses du ModÃ¨le"
                                   style="-fx-font-weight: bold; -fx-font-size: 17; -fx-text-fill: #2c3e50;"/>

                            <!-- Actions rapides -->
                            <VBox spacing="12" style="-fx-background-color: white; -fx-padding: 15; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸš€ Actions Rapides" style="-fx-font-weight: bold; -fx-font-size: 14;"/>

                                <FlowPane hgap="12" vgap="12">
                                    <Button fx:id="predictMissingButton" text="ðŸ”® PrÃ©dire Anomalies Manquantes"
                                            prefWidth="220" prefHeight="45"
                                            style="-fx-background-color: #8e44ad; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;"
                                            onAction="#handlePredictMissing"/>

                                    <Button fx:id="evaluateModelButton" text="ðŸ“Š Ã‰valuer le ModÃ¨le"
                                            prefWidth="220" prefHeight="45"
                                            style="-fx-background-color: #16a085; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;"
                                            onAction="#handleEvaluate"/>

                                    <Button fx:id="fullAnalysisButton" text="ðŸ”¬ Analyse ComplÃ¨te"
                                            prefWidth="220" prefHeight="45"
                                            style="-fx-background-color: #e74c3c; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;"
                                            onAction="#handleFullAnalysis"/>

                                    <Button text="ðŸ”Œ Test Connexion BD"
                                            prefWidth="220" prefHeight="45"
                                            style="-fx-background-color: #f39c12; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;"
                                            onAction="#testDatabaseConnection"/>

                                    <Button text="âœ… Valider ModÃ¨le"
                                            prefWidth="220" prefHeight="45"
                                            style="-fx-background-color: #27ae60; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 12;"
                                            onAction="#validateModel"/>
                                </FlowPane>
                            </VBox>

                            <!-- Journal systÃ¨me -->
                            <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="ðŸ“ Journal SystÃ¨me" style="-fx-font-weight: bold; -fx-font-size: 14;"
                                           HBox.hgrow="ALWAYS"/>
                                    <Button fx:id="clearLogsButton" text="ðŸ—‘ï¸ Effacer"
                                            style="-fx-background-color: #95a5a6; -fx-text-fill: white; -fx-padding: 5 12;"
                                            onAction="#handleClearLogs"/>
                                    <Button fx:id="exportLogsButton" text="ðŸ’¾ Exporter"
                                            style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-padding: 5 12;"
                                            onAction="#handleExportLogs"/>
                                </HBox>
                                <TextArea fx:id="systemLogArea" prefHeight="280" editable="false"
                                          style="-fx-font-family: 'Courier New'; -fx-font-size: 10; -fx-control-inner-background: #2c3e50; -fx-text-fill: #2ecc71;"/>
                            </VBox>

                            <!-- Logs d'anomalies -->
                            <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸš¨ Journal des Anomalies DÃ©tectÃ©es" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                                <TableView fx:id="anomalyLogTable" prefHeight="220"/>
                            </VBox>
                        </VBox>
                    </VBox>
                </Tab>

                <!-- Tab 5: Visualisations AvancÃ©es -->
                <Tab text="ðŸ“ˆ Visualisations">
                    <VBox spacing="15" style="-fx-background-color: transparent;">
                        <VBox spacing="15" style="-fx-padding: 15;">
                            <Label text="Visualisations et Analyses Statistiques"
                                   style="-fx-font-weight: bold; -fx-font-size: 17; -fx-text-fill: #2c3e50;"/>

                            <!-- Correlation chart -->
                            <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸ”— CorrÃ©lations entre Features" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                                <ScatterChart fx:id="correlationChart" prefHeight="250">
                                    <xAxis>
                                        <NumberAxis label="Feature 1"/>
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis label="Feature 2"/>
                                    </yAxis>
                                </ScatterChart>
                            </VBox>

                            <!-- Matrice de confusion -->
                            <VBox spacing="8" style="-fx-background-color: white; -fx-padding: 12; -fx-border-radius: 8; -fx-background-radius: 8; -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.1), 8, 0, 0, 0);">
                                <Label text="ðŸŽ¯ Matrice de Confusion" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                                <TableView fx:id="confusionMatrixTable" prefHeight="180">

                                    <placeholder>
                                        <Label text="Matrice de confusion vide"/>
                                    </placeholder>
                                </TableView>
                            </VBox>

                            <!-- Statistiques des features -->
                            <VBox spacing="10" prefHeight="300">
                                <Label text="ðŸ“Š Feature Statistics" />
                                <VBox spacing="15" style="-fx-padding: 15;">
                                    <TableView fx:id="featureStatsTable" prefHeight="280"/>
                                </VBox>
                            </VBox>
                        </VBox>
                    </VBox>
                </Tab>
            </TabPane>

            <!-- Bottom: Footer avec informations systÃ¨me -->
            <HBox spacing="12" alignment="CENTER" style="-fx-background-color: #34495e; -fx-padding: 10;">
                <Label fx:id="modelStatusLabel" text="ModÃ¨le: Non entraÃ®nÃ©"
                       style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 11;"/>
                <Separator orientation="VERTICAL" style="-fx-background-color: white;"/>
                <Label fx:id="lastTrainingLabel" text="Dernier entraÃ®nement: --"
                       style="-fx-text-fill: #ecf0f1; -fx-font-size: 10;"/>
                <Separator orientation="VERTICAL" style="-fx-background-color: white;"/>
                <Label fx:id="dataUpdateLabel" text="DerniÃ¨re mise Ã  jour: --"
                       style="-fx-text-fill: #ecf0f1; -fx-font-size: 10;"/>
                <Separator orientation="VERTICAL" style="-fx-background-color: white;"/>
                <Label fx:id="performanceStatusLabel" text="Performance: --"
                       style="-fx-text-fill: #ecf0f1; -fx-font-size: 10;"/>
            </HBox>
        </VBox>
    </content>
</ScrollPane>
