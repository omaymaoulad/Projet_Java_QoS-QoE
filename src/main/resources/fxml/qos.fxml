<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.effect.*?>

<ScrollPane xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.ensah.qoe.Controller.QoSController"
            fitToWidth="true"
            fitToHeight="false"
            hbarPolicy="NEVER"
            vbarPolicy="AS_NEEDED"
            style="-fx-background-color: transparent;"
            styleClass="qos-scroll-pane">

    <VBox spacing="0" alignment="TOP_CENTER"
          styleClass="qos-main-container"
          style="-fx-background-color: linear-gradient(to bottom, #e8f4f8, #ffffff);">

        <!-- En-tÃªte professionnel amÃ©liorÃ© -->
        <VBox spacing="12" alignment="CENTER" styleClass="qos-header"
              style="-fx-padding: 25 30 20 30; -fx-background-color: linear-gradient(to right, #5c160c, rgba(231,90,23,0.9)); -fx-effect: dropshadow(three-pass-box, rgba(0,0,0,0.15), 15, 0, 0, 5);">
            <HBox alignment="CENTER" spacing="18">
                <StackPane>
                    <Rectangle width="55" height="55" arcWidth="15" arcHeight="15"
                               fill="linear-gradient(to bottom right, #ff6b35, #ff8c42)">
                        <effect>
                            <DropShadow color="rgba(255,107,53,0.5)" radius="12" spread="0.4"/>
                        </effect>
                    </Rectangle>
                    <Text text="ðŸ“Š" style="-fx-font-size: 28; -fx-fill: white;"/>
                </StackPane>
                <VBox spacing="3">
                    <Label text="QUALITÃ‰ DE SERVICE"
                           styleClass="header-title"
                           style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 28; -fx-font-family: 'Segoe UI'; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.3), 3, 0, 0, 2);"/>
                    <Label text="Tableau de bord d'analyse des performances rÃ©seau"
                           styleClass="header-subtitle"
                           style="-fx-text-fill: #e0f2fe; -fx-font-size: 14; -fx-font-family: 'Segoe UI';"/>
                </VBox>
            </HBox>
        </VBox>

        <!-- Conteneur principal responsive -->
        <VBox spacing="20" styleClass="content-container" style="-fx-padding: 20 30 25 30;">

            <Label text="INDICATEURS DE PERFORMANCE" styleClass="section-title"
                   style="-fx-text-fill: #ff7232; -fx-font-weight: bold; -fx-font-size: 20; -fx-border-color: linear-gradient(to right, #ff6b35, #3b82f6); -fx-border-width: 0 0 2 0; -fx-padding: 0 0 10 0;"/>

            <!-- Grille des mÃ©triques responsive -->
            <GridPane hgap="15" vgap="15" styleClass="metrics-grid">
                <columnConstraints>
                    <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS" minWidth="180"/>
                    <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS" minWidth="180"/>
                    <ColumnConstraints percentWidth="33.33" hgrow="ALWAYS" minWidth="180"/>
                </columnConstraints>

                <!-- Ligne 1 -->
                <VBox spacing="8" alignment="CENTER_LEFT" GridPane.columnIndex="0" GridPane.rowIndex="0"
                      styleClass="metric-card metric-card-yellow"
                      style="-fx-background-color: linear-gradient(to bottom right, #fef3c7, #fde68a); -fx-background-radius: 12; -fx-padding: 18; -fx-border-color: #fbbf24; -fx-border-radius: 12; -fx-border-width: 2; -fx-effect: dropshadow(three-pass-box, rgba(251,191,36,0.3), 10, 0, 0, 3);">
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <Label text="â±" style="-fx-font-size: 22;"/>
                        <VBox spacing="2">
                            <Label text="Latence" styleClass="metric-label" style="-fx-text-fill: #92400e; -fx-font-weight: bold; -fx-font-size: 14;"/>
                            <Label text="Temps de rÃ©ponse" style="-fx-text-fill: #b45309; -fx-font-size: 11;"/>
                        </VBox>
                    </HBox>
                    <Label fx:id="latenceLabel" text="-" styleClass="metric-value"
                           style="-fx-text-fill: #d97706; -fx-font-weight: bold; -fx-font-size: 24; -fx-padding: 5 0 0 0;"/>
                </VBox>

                <VBox spacing="8" alignment="CENTER_LEFT" GridPane.columnIndex="1" GridPane.rowIndex="0"
                      styleClass="metric-card metric-card-cyan"
                      style="-fx-background-color: linear-gradient(to bottom right, #cffafe, #a5f3fc); -fx-background-radius: 12; -fx-padding: 18; -fx-border-color: #22d3ee; -fx-border-radius: 12; -fx-border-width: 2; -fx-effect: dropshadow(three-pass-box, rgba(34,211,238,0.3), 10, 0, 0, 3);">
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <Label text="ðŸŒŠ" style="-fx-font-size: 22;"/>
                        <VBox spacing="2">
                            <Label text="Jitter" styleClass="metric-label" style="-fx-text-fill: #164e63; -fx-font-weight: bold; -fx-font-size: 14;"/>
                            <Label text="Variation de latence" style="-fx-text-fill: #0e7490; -fx-font-size: 11;"/>
                        </VBox>
                    </HBox>
                    <Label fx:id="jitterLabel" text="-" styleClass="metric-value"
                           style="-fx-text-fill: #0891b2; -fx-font-weight: bold; -fx-font-size: 24; -fx-padding: 5 0 0 0;"/>
                </VBox>

                <VBox spacing="8" alignment="CENTER_LEFT" GridPane.columnIndex="2" GridPane.rowIndex="0"
                      styleClass="metric-card metric-card-red"
                      style="-fx-background-color: linear-gradient(to bottom right, #fecaca, #fca5a5); -fx-background-radius: 12; -fx-padding: 18; -fx-border-color: #f87171; -fx-border-radius: 12; -fx-border-width: 2; -fx-effect: dropshadow(three-pass-box, rgba(248,113,113,0.3), 10, 0, 0, 3);">
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <Label text="ðŸ“‰" style="-fx-font-size: 22;"/>
                        <VBox spacing="2">
                            <Label text="Perte paquets" styleClass="metric-label" style="-fx-text-fill: #7f1d1d; -fx-font-weight: bold; -fx-font-size: 14;"/>
                            <Label text="Taux de perte" style="-fx-text-fill: #991b1b; -fx-font-size: 11;"/>
                        </VBox>
                    </HBox>
                    <Label fx:id="perteLabel" text="-" styleClass="metric-value"
                           style="-fx-text-fill: #dc2626; -fx-font-weight: bold; -fx-font-size: 24; -fx-padding: 5 0 0 0;"/>
                </VBox>

                <!-- Ligne 2 -->
                <VBox spacing="8" alignment="CENTER_LEFT" GridPane.columnIndex="0" GridPane.rowIndex="1"
                      styleClass="metric-card metric-card-purple"
                      style="-fx-background-color: linear-gradient(to bottom right, #ddd6fe, #c4b5fd); -fx-background-radius: 12; -fx-padding: 18; -fx-border-color: #a78bfa; -fx-border-radius: 12; -fx-border-width: 2; -fx-effect: dropshadow(three-pass-box, rgba(167,139,250,0.3), 10, 0, 0, 3);">
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <Label text="ðŸ“¶" style="-fx-font-size: 22;"/>
                        <VBox spacing="2">
                            <Label text="Signal Score" styleClass="metric-label" style="-fx-text-fill: #4c1d95; -fx-font-weight: bold; -fx-font-size: 14;"/>
                            <Label text="QualitÃ© du signal" style="-fx-text-fill: #6d28d9; -fx-font-size: 11;"/>
                        </VBox>
                    </HBox>
                    <Label fx:id="signalLabel" text="-" styleClass="metric-value"
                           style="-fx-text-fill: #7c3aed; -fx-font-weight: bold; -fx-font-size: 24; -fx-padding: 5 0 0 0;"/>
                </VBox>

                <VBox spacing="8" alignment="CENTER_LEFT" GridPane.columnIndex="1" GridPane.rowIndex="1"
                      styleClass="metric-card metric-card-green"
                      style="-fx-background-color: linear-gradient(to bottom right, #d1fae5, #a7f3d0); -fx-background-radius: 12; -fx-padding: 18; -fx-border-color: #34d399; -fx-border-radius: 12; -fx-border-width: 2; -fx-effect: dropshadow(three-pass-box, rgba(52,211,153,0.3), 10, 0, 0, 3);">
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <Label text="â­" style="-fx-font-size: 22;"/>
                        <VBox spacing="2">
                            <Label text="MOS" styleClass="metric-label" style="-fx-text-fill: #065f46; -fx-font-weight: bold; -fx-font-size: 14;"/>
                            <Label text="Mean Opinion Score" style="-fx-text-fill: #047857; -fx-font-size: 11;"/>
                        </VBox>
                    </HBox>
                    <Label fx:id="mosLabel" text="-" styleClass="metric-value"
                           style="-fx-text-fill: #059669; -fx-font-weight: bold; -fx-font-size: 24; -fx-padding: 5 0 0 0;"/>
                </VBox>

                <VBox spacing="8" alignment="CENTER_LEFT" GridPane.columnIndex="2" GridPane.rowIndex="1"
                      styleClass="metric-card metric-card-blue"
                      style="-fx-background-color: linear-gradient(to bottom right, #bfdbfe, #93c5fd); -fx-background-radius: 12; -fx-padding: 18; -fx-border-color: #60a5fa; -fx-border-radius: 12; -fx-border-width: 2; -fx-effect: dropshadow(three-pass-box, rgba(96,165,250,0.3), 10, 0, 0, 3);">
                    <HBox spacing="12" alignment="CENTER_LEFT">
                        <Label text="ðŸš€" style="-fx-font-size: 22;"/>
                        <VBox spacing="2">
                            <Label text="Bande passante" styleClass="metric-label" style="-fx-text-fill: #1e3a8a; -fx-font-weight: bold; -fx-font-size: 14;"/>
                            <Label text="DÃ©bit disponible" style="-fx-text-fill: #1e40af; -fx-font-size: 11;"/>
                        </VBox>
                    </HBox>
                    <Label fx:id="bandePassanteLabel" text="-" styleClass="metric-value"
                           style="-fx-text-fill: #2563eb; -fx-font-weight: bold; -fx-font-size: 24; -fx-padding: 5 0 0 0;"/>
                </VBox>
            </GridPane>

            <!-- Zone d'analyse -->
            <VBox spacing="15" alignment="CENTER" styleClass="analysis-section"
                  style="-fx-padding: 15 0 0 0; -fx-border-color: #e5e7eb; -fx-border-width: 2 0 0 0;">
                <Label text="ANALYSE DES DONNÃ‰ES" styleClass="section-title"
                       style="-fx-text-fill: #1e3a8a; -fx-font-weight: bold; -fx-font-size: 18;"/>

                <Button fx:id="analyserButton" text="ðŸ“ Analyser le fichier CSV" onAction="#analyserQoS"
                        styleClass="analyze-button"
                        style="-fx-background-color: linear-gradient(to right, #ff6b35, #ff8c42); -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 15; -fx-background-radius: 10; -fx-padding: 14 40; -fx-cursor: hand; -fx-effect: dropshadow(three-pass-box, rgba(255,107,53,0.4), 12, 0, 0, 4); -fx-border-color: rgba(255,255,255,0.3); -fx-border-radius: 10; -fx-border-width: 1;"/>

                <Label text="Importez un fichier CSV contenant les mÃ©triques rÃ©seau"
                       styleClass="analysis-hint"
                       style="-fx-text-fill: #6b7280; -fx-font-size: 12; -fx-font-style: italic; -fx-text-alignment: center; -fx-wrap-text: true;"/>
            </VBox>

            <!-- Section Info -->
            <VBox spacing="12" styleClass="info-section"
                  style="-fx-background-color: white; -fx-background-radius: 12; -fx-padding: 20; -fx-border-color: #e5e7eb; -fx-border-radius: 12; -fx-border-width: 1; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 10, 0, 0, 3);">
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <Label text="ðŸ“‹" style="-fx-font-size: 18;"/>
                    <Label text="FORMAT CSV REQUIS" style="-fx-text-fill: #1e3a8a; -fx-font-weight: bold; -fx-font-size: 16;"/>
                </HBox>

                <VBox spacing="6">
                    <Label text="Colonnes attendues:" style="-fx-text-fill: #1f2937; -fx-font-size: 12; -fx-font-weight: bold;"/>
                    <Label text="â€¢ Latence (ms), Jitter (ms), Perte (%), Bande passante (Mbps)"
                           style="-fx-text-fill: #6b7280; -fx-font-size: 11; -fx-wrap-text: true;"/>
                    <Label text="â€¢ Signal Score, MOS (Mean Opinion Score)"
                           style="-fx-text-fill: #6b7280; -fx-font-size: 11; -fx-wrap-text: true;"/>
                    <Label text="â€¢ CellID, Zone, Type_connexion (optionnels)"
                           style="-fx-text-fill: #6b7280; -fx-font-size: 11; -fx-wrap-text: true;"/>
                </VBox>
            </VBox>

            <!-- Statut -->
            <HBox spacing="15" alignment="CENTER" styleClass="status-section"
                  style="-fx-background-color: linear-gradient(to right, #1e3a8a, #3b82f6); -fx-background-radius: 12; -fx-padding: 20; -fx-effect: dropshadow(three-pass-box, rgba(30,58,138,0.3), 12, 0, 0, 4);">
                <HBox spacing="8" alignment="CENTER">
                    <Circle radius="4" fill="#22c55e">
                        <effect>
                            <DropShadow color="#22c55e" radius="8" spread="0.6"/>
                        </effect>
                    </Circle>
                    <Label text="SystÃ¨me opÃ©rationnel" style="-fx-text-fill: white; -fx-font-size: 14; -fx-font-weight: bold;"/>
                </HBox>
                <Label text="â€¢" style="-fx-text-fill: rgba(255,255,255,0.5);"/>
                <Label text="PrÃªt pour analyse" style="-fx-text-fill: #bfdbfe; -fx-font-size: 13;"/>
            </HBox>

            <!-- Pied de page -->
            <HBox alignment="CENTER" styleClass="footer" style="-fx-padding: 20 0 10 0;">
                <Label text="QoS Analysis System â€¢ v2.0 â€¢ Â© 2024"
                       style="-fx-text-fill: #9ca3af; -fx-font-size: 11; -fx-font-family: 'Segoe UI';"/>
            </HBox>

        </VBox>
    </VBox>
</ScrollPane>