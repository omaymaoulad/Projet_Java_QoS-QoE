<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.scene.shape.*?>

<AnchorPane fx:id="rootPane"
            xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.ensah.qoe.Controller.LoginController"
            minWidth="600.0" minHeight="500.0"
            prefHeight="650.0" prefWidth="1200.0"
            styleClass="root-container"
            stylesheets="@../css/style.css">

    <!-- Barre de titre avec boutons de contrÃ´le -->
    <HBox fx:id="titleBar" styleClass="title-bar"
          AnchorPane.topAnchor="0.0" AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0">
        <Region HBox.hgrow="ALWAYS"/>
    </HBox>

    <!-- Particules dÃ©coratives simplifiÃ©es -->
    <Circle fill="#FF6B35" layoutX="150" layoutY="120" opacity="0.08" radius="100" styleClass="particle"/>
    <Circle fill="#FF8C42" layoutX="1050" layoutY="550" opacity="0.06" radius="130" styleClass="particle"/>

    <!-- Container Principal Responsive -->
    <HBox fx:id="mainContainer" alignment="CENTER" spacing="0"
          AnchorPane.topAnchor="40.0" AnchorPane.bottomAnchor="0.0"
          AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0">

        <!-- ========== PANNEAU GAUCHE - BRANDING ========== -->
        <VBox fx:id="leftPanel" alignment="CENTER" prefWidth="540.0" spacing="35" styleClass="left-panel">
            <padding>
                <Insets top="60" right="50" bottom="60" left="50"/>
            </padding>

            <!-- Logo Innovant et Explicatif QOS/QOE -->
            <VBox alignment="CENTER" spacing="20">

                <!-- Logo principal avec design explicatif -->
                <StackPane styleClass="logo-container">
                    <!-- Cercles de signal (comme des ondes) -->
                    <Circle fill="transparent" radius="110" stroke="rgba(255, 255, 255, 0.25)" strokeWidth="2" styleClass="signal-circle"/>
                    <Circle fill="transparent" radius="85" stroke="rgba(255, 255, 255, 0.3)" strokeWidth="2.5" styleClass="signal-circle"/>
                    <Circle fill="transparent" radius="60" stroke="rgba(255, 255, 255, 0.35)" strokeWidth="3" styleClass="signal-circle"/>

                    <!-- Container central du logo -->
                    <VBox alignment="CENTER" spacing="8">
                        <!-- IcÃ´ne explicative : Graphique de qualitÃ© -->
                        <HBox alignment="CENTER" spacing="3">
                            <!-- Barres de signal croissantes -->
                            <VBox alignment="BOTTOM_CENTER" spacing="2">
                                <Rectangle fill="white" width="8" height="15" arcWidth="4" arcHeight="4"/>
                            </VBox>
                            <VBox alignment="BOTTOM_CENTER" spacing="2">
                                <Rectangle fill="white" width="8" height="28" arcWidth="4" arcHeight="4"/>
                            </VBox>
                            <VBox alignment="BOTTOM_CENTER" spacing="2">
                                <Rectangle fill="white" width="8" height="42" arcWidth="4" arcHeight="4"/>
                            </VBox>
                            <VBox alignment="BOTTOM_CENTER" spacing="2">
                                <Rectangle fill="white" width="8" height="55" arcWidth="4" arcHeight="4"/>
                            </VBox>
                            <VBox alignment="BOTTOM_CENTER" spacing="2">
                                <Rectangle fill="white" width="8" height="68" arcWidth="4" arcHeight="4"/>
                            </VBox>
                        </HBox>

                        <!-- Texte QOS/QOE stylisÃ© -->
                        <HBox alignment="CENTER" spacing="6">
                            <Label text="QOS" styleClass="logo-text-primary">
                                <font><Font name="System Bold" size="36"/></font>
                            </Label>
                            <Circle fill="white" radius="4"/>
                            <Label text="QOE" styleClass="logo-text-secondary">
                                <font><Font name="System Bold" size="36"/></font>
                            </Label>
                        </HBox>
                    </VBox>
                </StackPane>

                <!-- Titre principal -->
                <VBox alignment="CENTER" spacing="10">
                    <Label text="Quality Monitoring" styleClass="brand-title">
                        <font><Font name="System Bold" size="38"/></font>
                    </Label>
                    <Label text="Performance et Experience Analysis" styleClass="brand-subtitle">
                        <font><Font name="System Bold" size="16"/></font>
                    </Label>
                </VBox>

                <!-- Ligne sÃ©paratrice -->
                <HBox alignment="CENTER" prefWidth="350" spacing="12">
                    <Line endX="65" startX="0" styleClass="separator-line"/>
                    <Circle fill="white" opacity="0.7" radius="3.5"/>
                    <Line endX="65" startX="0" styleClass="separator-line"/>
                </HBox>

                <!-- Description claire -->
                <VBox alignment="CENTER" spacing="8" maxWidth="420">
                    <Label text="Surveillez et optimisez la qualitÃ© de service"
                           styleClass="tagline-text" textAlignment="CENTER" wrapText="true">
                        <font><Font name="System Bold" size="15"/></font>
                    </Label>
                    <Label text="en temps rÃ©el pour une expÃ©rience utilisateur optimale"
                           styleClass="tagline-text" textAlignment="CENTER" wrapText="true">
                        <font><Font name="System Bold" size="15"/></font>
                    </Label>
                </VBox>
            </VBox>

            <!-- FonctionnalitÃ©s clÃ©s avec icÃ´nes claires -->
            <VBox spacing="16" maxWidth="450">

                <!-- Feature 1 -->
                <HBox spacing="18" alignment="CENTER_LEFT" styleClass="feature-card">
                    <StackPane styleClass="feature-icon-container" prefWidth="50" prefHeight="50">
                        <Circle fill="rgba(255, 107, 53, 0.2)" radius="25"/>
                        <Label text="ðŸ“Š" style="-fx-font-size: 26px;"/>
                    </StackPane>
                    <VBox spacing="4" HBox.hgrow="ALWAYS">
                        <Label text="Analyse en Temps RÃ©el" styleClass="feature-title">
                            <font><Font name="System Bold" size="15"/></font>
                        </Label>
                        <Label text="Surveillance continue des performances rÃ©seau"
                               styleClass="feature-description" wrapText="true">
                            <font><Font name="System Bold" size="12"/></font>
                        </Label>
                    </VBox>
                </HBox>

                <!-- Feature 2 -->
                <HBox spacing="18" alignment="CENTER_LEFT" styleClass="feature-card">
                    <StackPane styleClass="feature-icon-container" prefWidth="50" prefHeight="50">
                        <Circle fill="rgba(255, 140, 66, 0.2)" radius="25"/>
                        <Label text="ðŸ“ˆ" style="-fx-font-size: 26px;"/>
                    </StackPane>
                    <VBox spacing="4" HBox.hgrow="ALWAYS">
                        <Label text="Rapports DÃ©taillÃ©s" styleClass="feature-title">
                            <font><Font name="System Bold" size="15"/></font>
                        </Label>
                        <Label text="Tableaux de bord complets et visualisations"
                               styleClass="feature-description" wrapText="true">
                            <font><Font name="System Bold" size="12"/></font>
                        </Label>
                    </VBox>
                </HBox>

                <!-- Feature 3 -->
                <HBox spacing="18" alignment="CENTER_LEFT" styleClass="feature-card">
                    <StackPane styleClass="feature-icon-container" prefWidth="50" prefHeight="50">
                        <Circle fill="rgba(255, 165, 82, 0.2)" radius="25"/>
                        <Label text="ðŸ”" style="-fx-font-size: 26px;"/>
                    </StackPane>
                    <VBox spacing="4" HBox.hgrow="ALWAYS">
                        <Label text="AccÃ¨s SÃ©curisÃ©" styleClass="feature-title">
                            <font><Font name="System Bold" size="15"/></font>
                        </Label>
                        <Label text="Authentification robuste et gestion des rÃ´les"
                               styleClass="feature-description" wrapText="true">
                            <font><Font name="System Bold" size="12"/></font>
                        </Label>
                    </VBox>
                </HBox>
            </VBox>

            <!-- Statut de connexion -->
            <HBox alignment="CENTER" spacing="12">
                <Label text="Version 2.0" styleClass="version-badge">
                    <font><Font name="System Bold" size="11"/></font>
                </Label>
                <Label fx:id="connectionStatusLabel" text="ðŸŸ¡ VÃ©rification..." styleClass="connection-status">
                    <font><Font name="System Bold" size="11"/></font>
                </Label>
            </HBox>
        </VBox>

        <!-- ========== PANNEAU DROIT - FORMULAIRE ========== -->
        <VBox alignment="CENTER" prefWidth="660.0" spacing="35" styleClass="right-panel">
            <padding>
                <Insets top="60" right="60" bottom="60" left="60"/>
            </padding>

            <!-- Carte de formulaire responsive -->
            <VBox fx:id="formCard" alignment="TOP_CENTER" spacing="25"
                  maxWidth="480" styleClass="form-card">
                <padding>
                    <Insets top="45" right="40" bottom="45" left="40"/>
                </padding>

                <!-- En-tÃªte -->
                <VBox alignment="CENTER" spacing="12">
                    <Label text="Connexion" styleClass="form-header">
                        <font><Font name="System Bold" size="40"/></font>
                    </Label>
                    <Label text="AccÃ©dez Ã  votre espace QOS/QOE" styleClass="form-subheader">
                        <font><Font name="System Bold" size="14"/></font>
                    </Label>
                </VBox>

                <!-- Champ Username -->
                <VBox spacing="10" styleClass="input-container">
                    <Label text="Nom d'utilisateur" styleClass="input-label">
                        <font><Font name="System Bold" size="14"/></font>
                    </Label>
                    <StackPane>
                        <TextField fx:id="usernameField"
                                   promptText="Entrez votre identifiant"
                                   styleClass="modern-input">
                            <font><Font name="System Bold" size="14"/></font>
                        </TextField>
                        <HBox alignment="CENTER_LEFT" pickOnBounds="false" StackPane.alignment="CENTER_LEFT">
                            <padding><Insets left="16"/></padding>
                            <Label text="ðŸ‘¤" styleClass="input-icon">
                                <font><Font size="20"/></font>
                            </Label>
                        </HBox>
                    </StackPane>
                </VBox>

                <!-- Champ Password -->
                <VBox spacing="10" styleClass="input-container">
                    <Label text="Mot de passe" styleClass="input-label">
                        <font><Font name="System Bold" size="14"/></font>
                    </Label>
                    <StackPane>
                        <PasswordField fx:id="passwordField"
                                       promptText="Entrez votre mot de passe"
                                       styleClass="modern-input">
                            <font><Font name="System Bold" size="14"/></font>
                        </PasswordField>

                        <TextField fx:id="passwordVisibleField"
                                   promptText="Entrez votre mot de passe"
                                   styleClass="modern-input"
                                   visible="false" managed="false">
                            <font><Font name="System Bold" size="14"/></font>
                        </TextField>

                        <HBox alignment="CENTER_LEFT" pickOnBounds="false" StackPane.alignment="CENTER_LEFT">
                            <padding><Insets left="16"/></padding>
                            <Label text="ðŸ”’" styleClass="input-icon">
                                <font><Font size="20"/></font>
                            </Label>
                        </HBox>

                        <Button fx:id="togglePasswordButton"
                                text="ðŸ‘"
                                onAction="#togglePasswordVisibility"
                                styleClass="password-toggle-btn"
                                StackPane.alignment="CENTER_RIGHT">
                            <font><Font size="16"/></font>
                        </Button>
                    </StackPane>
                </VBox>

                <!-- Messages -->
                <VBox spacing="10">
                    <Label fx:id="errorLabel" text="" styleClass="error-message"
                           wrapText="true" visible="false" managed="false">
                        <font><Font name="System Bold" size="13"/></font>
                    </Label>
                    <Label fx:id="successLabel" text="" styleClass="success-message"
                           wrapText="true" visible="false" managed="false">
                        <font><Font name="System Bold" size="13"/></font>
                    </Label>
                </VBox>

                <!-- Options -->
                <HBox alignment="CENTER" spacing="15">
                    <CheckBox fx:id="rememberMeCheckbox"
                              text="Se souvenir"
                              styleClass="remember-checkbox">
                        <font><Font name="System Bold" size="12"/></font>
                    </CheckBox>
                    <Region HBox.hgrow="ALWAYS"/>
                    <Hyperlink text="Mot de passe oubliÃ© ?"
                               onAction="#handleForgotPassword"
                               styleClass="forgot-link">
                        <font><Font name="System Bold" size="12"/></font>
                    </Hyperlink>
                </HBox>

                <!-- Bouton connexion -->
                <StackPane>
                    <Button fx:id="loginButton"
                            text="Se connecter"
                            onAction="#handleLogin"
                            maxWidth="Infinity"
                            prefHeight="54"
                            styleClass="login-button">
                        <font><Font name="System Bold" size="16"/></font>
                    </Button>

                    <ProgressIndicator fx:id="progressIndicator"
                                       maxHeight="32" maxWidth="32"
                                       visible="false"
                                       styleClass="loader"/>
                </StackPane>
            </VBox>

            <!-- Footer -->
            <VBox alignment="CENTER" spacing="8">
                <Label text="Â© 2025 QOS/QOE System" styleClass="copyright">
                    <font><Font name="System Bold" size="11"/></font>
                </Label>
            </VBox>
        </VBox>
    </HBox>
</AnchorPane>